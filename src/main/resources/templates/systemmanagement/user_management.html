<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.springframework.org/schema/jdbc">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="layui/css/layui.css">
    <script src="layui/layui.js"></script>
    <script src="js/jQuery/jquery-2.2.3.min.js"></script>
    <script type="text/javascript">
        $(function () {
            readList();
        })
        layui.use(['laypage', 'layer','form','upload'], function() {
            var laypage = layui.laypage;
            layer = layui.layer;
            var $ = layui.jquery
                ,upload = layui.upload;
            //自定义样式
            laypage.render({
                elem: 'demo2'
                , count: 100
                , theme: '#1E9FFF'
            });
            upload.render({
                elem: '#uploadFile'
                ,url: 'http://localhost:8080/uploadFile' //自己的上传接口
                ,accept: 'file' //普通文件
                ,done: function(res){
                    layer.msg('上传成功');
                    console.log(res);
                }
            });
        })

      /*  查询所有信息*/
        function readList() {
            $("#tbody").empty();
            var userId = $("#userId").val();
            var userAccount = $("#userAccount").val();
            var contactAddress = $("#contactAddress").val();
            $.ajax({
                url:"findUserAll",
                data:{
                    "userId":userId,
                    "userAccount":userAccount,
                    "contactAddress":contactAddress,
                    "userState":0
                },
                type:"post",
                dataType:"json",
                success:function (data) {
                    /*layer.open({
                        title: '执行结果'
                        ,content: '查询成功'
                        ,time: 1000
                        ,anim: 5
                    });*/
                    var v = "";
                    for (var i = 0; i < data.length; i++) {
                        v += "<tr>";
                        v += '<td><input type="checkbox" value="'+data[i].userId+'" name="chose" /></td>'
                       /* v += "<td>"+data[i].userId+"</td>"*/
                        v += "<td>"+data[i].userAccount+"</td>"
                        v += "<td>"+data[i].role.roleDescription+"</td>"
                        v += "<td>"+data[i].username+"</td>"
                        v += "<td>"+data[i].userUnit+"</td>"
                        v += "<td>"+data[i].contactAddress+"</td>"
                        v += "<td>"+data[i].postalCode+"</td>"
                        v += "<td>"+data[i].contacts+"</td>"
                        v += "<td>"+data[i].userPhone+"</td>"
                        v += "<td>"+data[i].userEmail+"</td>"
                        v += '<td><button class="layui-btn  layui-btn-normal layui-btn-sm" onclick="lookInformation('+data[i].userId+')">查看</button></td>';
                        v += '<td><button class="layui-btn  layui-btn-warm layui-btn-sm" onclick="editInformation('+data[i].userId+')">修改</button></td>';
                        v += '<td><button class="layui-btn  layui-btn-danger layui-btn-sm " lay-event="del" onclick="removeInformation('+data[i].userId+')">删除</button></td>';
                        v += "</tr>";
                    }
                    $("#tbody").append(v);
                }
            })
        }

        /*添加页面弹出层*/
        function addInformation() {
            layer.open({
                //layer提供了5种层类型。可传入的值有：0（信息框，默认）1（页面层）2（iframe层）3（加载层）4（tips层）
                type:1,
                title:['添加卫生局用户','font-size:18px;'],
                area:['70%','70%'],
                anim:5,
                scrollbar: false,
                content:$("#form_add")
            })
        }
        /*修改页面弹出层*/
        function editInformation(){
            layer.open({
                type:1,
                title:['修改卫生局用户','font-size:18px;'],
                area:['50%','50%'],
                anim:5,
                scrollbar:false,
                content:$("#edit_add")
            })
        }
        /*删除提示弹出框*/
        function removeInformation(userId) {
            layui.use('layer',function () {
                var layer = layui.layer;
                layer.msg('确定要删除吗?',{
                    time:2000,
                    btn:['确定','取消'],
                    yes:function (index) {
                        console.log(userId);
                        $.ajax({
                            url:"updateUserSave",
                            type:"post",
                            dataType:"json",
                            async:false,
                            data:{
                                "userId":userId,
                                "userState":1
                            },
                            success:function(data){
                                console.log(data);
                                layer.msg(data.msg);
                                location.reload();
                            },error:function (data) {
                                $.message('错误',data.msg);
                            }
                        })
                        layer.close(index);
                    }
                })
                
            })
        }
        function downExcel() {
            var v = document.getElementsByName("chose");
            var array = new Array();
            for (var i = 0; i < v.length; i++) {
                if (v[i].checked){
                    array.push(v[i].value);
                }
            }
            window.location.href="outputUserExcel?ids="+array.toString();
        }
        function down() {
            window.location.href="down";
        }
    </script>
    <style>
        body{
            padding: 0;
            margin: 0;
        }
        .li-style li{
            float: left;
            list-style: none;
        }
        .healthBureau_ops{
            margin-right:1000px;
            float: left;
        }
        #find{
            float: right;
            margin-right: 100px;
        }
    </style>
</head>
<body>
<div class="healthBureau" style="padding: 15px;">
    <div id="healthBureau_head">
        <form class="layui-form" action="">
            <ul class="li-style">
                <li><div class="layui-form-item">
                    <label class="layui-form-label">ID</label>
                    <div class="layui-input-block">
                        <input type="text" name="userId" id = "userId" placeholder="请输入ID" class="layui-input" style="width: 200px">
                    </div>
                </div></li>
                <li><div class="layui-form-item">
                    <label class="layui-form-label">用户名称</label>
                    <div class="layui-input-block">
                        <input type="text" name="userAccount" id="userAccount" placeholder="请输入用户名称" class="layui-input" style="width: 200px">
                    </div>
                </div></li>
                <li><div class="layui-form-item">
                    <label class="layui-form-label">联系地址</label>
                    <div class="layui-input-block">
                        <input type="text" name="contactAddress" id="contactAddress"  placeholder="请输入联系地址" class="layui-input" style="width: 200px">
                    </div>
                </div></li>
            </ul>
        </form>
        <button class="layui-btn layui-btn-normal layui-btn-lg" id="find" onclick="readList()">查询</button>
    </div>
    <div class="healthBureau_ops layui-btn-group">
        <button class="layui-btn layui-btn-normal layui-btn-lg" onclick="addInformation()">添加</button>
        <button class="layui-btn layui-btn-normal layui-btn-lg" id="downloadFile" onclick="downExcel()">导出</button>
        <button class="layui-btn layui-btn-normal layui-btn-lg" id="uploadFile">导入</button>
    </div>
    <div>
        <table class="layui-table">
            <!--<colgroup>
                <col width="150">
                <col width="200">
                <col>
            </colgroup>-->
            <thead>
            <tr>
                <th></th>
                <th>用户名</th>
                <th>用户类别</th>
                <th>用户账号</th>
                <th>单位名称</th>
                <th>联系地址</th>
                <th>邮政编码</th>
                <th>联系人</th>
                <th>联系方式</th>
                <th>邮箱</th>
                <th>查看</th>
                <th>修改</th>
                <th>删除</th>
            </tr>
            </thead>
            <tbody id="tbody">

            </tbody>
        </table>
    </div>
    <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
        <!--  <legend>自定义主题 - 颜色随意定义</legend>-->
    </fieldset>
    <div id="demo2"></div>
    <!-- 添加表单-->
    <form class="" id="form_add" style="display: none">
        <div class="layui-form-item">
            <label class="layui-form-label">用户账号</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入用户账号" style="width: 200px">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">用户名称</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入用户名称" style="width: 200px">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">用户角色</label>
            <div class="layui-input-block">
                <select name="city" lay-verify="required">
                    <option value="">请选择</option>
                    <option value="0">卫生局</option>
                    <option value="1">卫生院</option>
                    <option value="2">卫生室</option>
                    <option value="3">供货商</option>
                    <option value="4">监督机构</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">所在单位</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入所在单位" style="width: 200px">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">联系地址</label>
            <select name="p" lay-verify="required">
                <option value="">请选择省</option>
                <option value="0">北京</option>
                <option value="0">上海</option>
            </select>
            <select name="c" lay-verify="required">
                <option value="">请选择市</option>
                <option value="0">海淀区</option>
                <option value="0">朝阳区</option>
            </select>
            <select name="t" lay-verify="required">
                <option value="">请选择县</option>
                <option value="0">西二旗</option>
                <option value="0">上地</option>
            </select>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">详细地址</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入详细地址 例如乡/村/门牌号" style="width: 200px">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">邮政编码</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入邮政编码" style="width: 200px">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">联系方式</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入联系方式" style="width: 200px">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">邮箱</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入邮箱" style="width: 200px">
            </div>
        </div>
        <div style="text-align: center">
            <button class="layui-btn layui-btn-normal layui-btn-lg" style="float: left;margin-left:100px">提交</button>
            <button class="layui-btn layui-btn-normal layui-btn-lg closebtn" style="float: right;margin-right:100px">取消</button>
        </div>
    </form>
    <!-- 修改表单-->
    <form class="" id="edit_add" style="display: none">
        <div class="layui-form-item">
            <label class="layui-form-label">用户账号</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入用户账号" style="width: 200px">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">用户名称</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入用户名称" style="width: 200px">
            </div>
        </div>
        <div class="">
            <select name="role" lay-verify="">
                <option value="">请选择</option>
                <option value="0">卫生局</option>
                <option value="0">卫生院</option>
                <option value="0">卫生室</option>
                <option value="0">监督者</option>
                <option value="0">管理员</option>
            </select>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">所在单位</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入所在单位" style="width: 200px">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">联系地址</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入联系地址" style="width: 200px">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">邮政编码</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入邮政编码" style="width: 200px">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">联系方式</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入联系方式" style="width: 200px">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">邮箱</label>
            <div class="layui-input-block">
                <input class="layui-input" type="text" name="title" placeholder="请输入邮箱" style="width: 200px">
            </div>
        </div>
        <div style="text-align: center">
            <button class="layui-btn layui-btn-normal layui-btn-lg" style="float: left;margin-left:100px">提交</button>
            <button class="layui-btn layui-btn-normal layui-btn-lg closebtn" style="float: right;margin-right:100px">取消</button>
        </div>
    </form>
</div>
</body>
</html>