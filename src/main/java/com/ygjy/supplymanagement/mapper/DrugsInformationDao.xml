<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ygjy.supplymanagement.dao.DrugsInformationDao">
    <resultMap id="BaseResultMap" type="com.ygjy.supplymanagement.pojo.DrugInformation">
        <id column="iid" jdbcType="INTEGER" property="id" />
        <result column="serial_number" jdbcType="VARCHAR" property="serialNumber" />
        <result column="common_name" jdbcType="VARCHAR" property="commonName" />
        <result column="dosage_form_id" jdbcType="INTEGER" property="dosageFormId" />
        <result column="specification" jdbcType="VARCHAR" property="specification" />
        <result column="conversion_fraction" jdbcType="VARCHAR" property="conversionFraction" />
        <result column="enterprise_name_id" jdbcType="VARCHAR" property="enterpriseNameId" />
        <result column="trade_name" jdbcType="VARCHAR" property="tradeName" />
        <result column="bidding_price" jdbcType="REAL" property="biddingPrice" />
        <result column="unit" jdbcType="VARCHAR" property="unit" />
        <result column="common_name_pinyin" jdbcType="VARCHAR" property="commonNamePinyin" />
        <result column="product_picture" jdbcType="VARCHAR" property="productPicture" />
        <result column="approval_number" jdbcType="VARCHAR" property="approvalNumber" />
        <result column="validity_of_approval_number" jdbcType="VARCHAR" property="validityOfApprovalNumber" />
        <result column="imported_drug" jdbcType="INTEGER" property="importedDrug" />
        <result column="packaging_material" jdbcType="VARCHAR" property="packagingMaterial" />
        <result column="packing_unit" jdbcType="VARCHAR" property="packingUnit" />
        <result column="latest_retail_price" jdbcType="REAL" property="latestRetailPrice" />
        <result column="source_of_retail_price" jdbcType="VARCHAR" property="sourceOfRetailPrice" />
        <result column="quality_level_id" jdbcType="INTEGER" property="qualityLevelId" />
        <result column="quality_level_description" jdbcType="VARCHAR" property="qualityLevelDescription" />
        <result column="drug_inspection_report" jdbcType="INTEGER" property="drugInspectionReport" />
        <result column="drug_inspection_report_number" jdbcType="VARCHAR" property="drugInspectionReportNumber" />
        <result column="validity_of_drug_inspection_report" jdbcType="DATE" property="validityOfDrugInspectionReport" />
        <result column="description_of_products" jdbcType="VARCHAR" property="descriptionOfProducts" />
        <result column="drug_category_id" jdbcType="INTEGER" property="drugCategoryId" />
        <result column="drug_transaction_status_id" jdbcType="INTEGER" property="drugTransactionStatusId" />
        <result column="del_state" jdbcType="INTEGER" property="delState" />
        <result column="audit_status" jdbcType="INTEGER" property="auditStatus" />
        <association property="durgsFrom" javaType="com.ygjy.supplymanagement.pojo.DurgsFrom">
            <id column="durg_from_id" jdbcType="INTEGER" property="durgFromId" />
            <result column="drug_from" jdbcType="VARCHAR" property="drugFrom" />
            <result column="note" jdbcType="VARCHAR" property="note" />
        </association>
        <association property="drugTransactionStatus" javaType="com.ygjy.supplymanagement.pojo.DrugTransactionStatus">
            <id column="sid" jdbcType="INTEGER" property="id" />
            <result column="drug_transaction_status" jdbcType="VARCHAR" property="drugTransactionStatus" />
            <result column="drug_transaction_explain" jdbcType="VARCHAR" property="drugTransactionExplain" />
        </association>
        <association property="drugCategory" javaType="com.ygjy.supplymanagement.pojo.DrugCategory">
            <id column="drugCateGoryId" property="drug_category_Id" jdbcType="INTEGER" />
            <result column="drug_category_name" property="drugCategoryName" jdbcType="VARCHAR" />
        </association>
        <association property="qualityLevel" javaType="com.ygjy.supplymanagement.pojo.QualityLevel">
            <id column="qua_id" jdbcType="INTEGER" property="quaId" />
            <result column="level" jdbcType="VARCHAR" property="level" />
        </association>
        <association property="enterprise" javaType="com.ygjy.supplymanagement.pojo.Enterprise">
            <id column="eid" jdbcType="INTEGER" property="id" />
            <result column="enterprise_name" jdbcType="VARCHAR" property="enterpriseName" />
            <result column="enterprise_type" jdbcType="VARCHAR" property="enterpriseType" />
            <result column="license" jdbcType="VARCHAR" property="license" />
            <result column="license_expiration_date" jdbcType="DATE" property="licenseExpirationDate" />
            <result column="enterprise_contacts" jdbcType="VARCHAR" property="enterpriseContacts" />
            <result column="enterprise_telephone" jdbcType="VARCHAR" property="enterpriseTelephone" />
            <result column="business_scope" jdbcType="VARCHAR" property="businessScope" />
            <result column="registered_address" jdbcType="VARCHAR" property="registeredAddress" />
            <result column="contact_address" jdbcType="VARCHAR" property="contactAddress" />
            <result column="postal_Code" jdbcType="VARCHAR" property="postalCode" />
            <result column="total_assets" jdbcType="REAL" property="totalAssets" />
            <result column="corporate_fax" jdbcType="VARCHAR" property="corporateFax" />
            <result column="legal_person" jdbcType="VARCHAR" property="legalPerson" />
            <result column="legal_person_id_card" jdbcType="VARCHAR" property="legalPersonIdCard" />
            <result column="enterprise_registered_capital" jdbcType="REAL" property="enterpriseRegisteredCapital" />
            <result column="sales_amount_last_year" jdbcType="REAL" property="salesAmountLastYear" />
            <result column="email" jdbcType="VARCHAR" property="email" />
            <result column="website" jdbcType="VARCHAR" property="website" />
            <result column="enterprise_code" jdbcType="VARCHAR" property="enterpriseCode" />
            <result column="enterprise_code_date" jdbcType="DATE" property="enterpriseCodeDate" />
            <result column="business_license" jdbcType="VARCHAR" property="businessLicense" />
            <result column="business_license _date" jdbcType="DATE" property="businessLicenseDate" />
            <result column="enterprise_letter_of_credit" jdbcType="INTEGER" property="enterpriseLetterOfCredit" />
            <result column="enterprise_letter_number" jdbcType="VARCHAR" property="enterpriseLetterNumber" />
            <result column="enterprise_letter_data" jdbcType="DATE" property="enterpriseLetterData" />
            <result column="fixed_assets" jdbcType="REAL" property="fixedAssets" />
            <result column="company_profile" jdbcType="VARCHAR" property="companyProfile" />
            <result column="remark" jdbcType="VARCHAR" property="remark" />
            <result column="del_state" jdbcType="INTEGER" property="delState" />
        </association>
        <association property="enterpriseDrugCatalog" javaType="com.ygjy.supplymanagement.pojo.EnterpriseDrugCatalog">
            <id column="fid" jdbcType="INTEGER" property="id" />
            <result column="enterprise_id" jdbcType="INTEGER" property="enterpriseId" />
            <result column="drug_information_id" jdbcType="INTEGER" property="drugInformationId" />
        </association>
        <association property="suppliers" javaType="com.ygjy.supplymanagement.pojo.Suppliers">
            <id column="suppliers_id" jdbcType="INTEGER" property="suppliersid" />
            <result column="supplier_name" jdbcType="INTEGER" property="suppliername" />
        </association>
        <association property="hospitalTransactionDetails" javaType="com.ygjy.supplymanagement.pojo.HospitalTransactionDetails">
            <id column="hid" jdbcType="INTEGER" property="id" />
            <result column="purchase_orders_id" jdbcType="INTEGER" property="purchaseOrdersId" />
            <result column="drug_information_id" jdbcType="INTEGER" property="drugInformationId" />
            <result column="enterprise_id" jdbcType="INTEGER" property="enterpriseId" />
            <result column="bidding_price" jdbcType="REAL" property="biddingPrice" />
            <result column="transaction_price" jdbcType="REAL" property="transactionPrice" />
            <result column="purchased_amount" jdbcType="INTEGER" property="purchasedAmount" />
            <result column="purchased_money" jdbcType="REAL" property="purchasedMoney" />
            <result column="purchased_state" jdbcType="INTEGER" property="purchasedState" />
            <result column="receipt_amount" jdbcType="INTEGER" property="receiptAmount" />
            <result column="receipt_money" jdbcType="REAL" property="receiptMoney" />
            <result column="Invoice_number" jdbcType="VARCHAR" property="invoiceNumber" />
            <result column="drug_batch_number" jdbcType="VARCHAR" property="drugBatchNumber" />
            <result column="drug_Validity" jdbcType="VARCHAR" property="drugValidity" />
            <result column="receipt_time" jdbcType="TIMESTAMP" property="receiptTime" />
            <result column="return_order_id" jdbcType="INTEGER" property="returnOrderId" />
            <result column="returns_the_amount" jdbcType="INTEGER" property="returnsTheAmount" />
            <result column="returns_the_money" jdbcType="REAL" property="returnsTheMoney" />
            <result column="reason_for_return" jdbcType="VARCHAR" property="reasonForReturn" />
            <result column="return_state_id" jdbcType="INTEGER" property="returnStateId" />
            <result column="final_settlement _id" jdbcType="INTEGER" property="finalSettlementId" />
            <result column="final_settlement _amount" jdbcType="INTEGER" property="finalSettlementAmount" />
            <result column="final_settlement _money" jdbcType="REAL" property="finalSettlementMoney" />
            <result column="settlement _state_id" jdbcType="INTEGER" property="settlementStateId" />
        </association>
        <association property="hospitalTransactionReturn" javaType="com.ygjy.supplymanagement.pojo.HospitalTransactionReturn">
            <id column="gid" jdbcType="INTEGER" property="id" />
            <result column="return_order_number" jdbcType="VARCHAR" property="returnOrderNumber" />
            <result column="return_order_name" jdbcType="VARCHAR" property="returnOrderName" />
            <result column="hospital_id" jdbcType="INTEGER" property="hospitalId" />
            <result column="contacts" jdbcType="VARCHAR" property="contacts" />
            <result column="phone" jdbcType="VARCHAR" property="phone" />
            <result column="creat_receipts_person" jdbcType="VARCHAR" property="creatReceiptsPerson" />
            <result column="create_receipts_time" jdbcType="TIMESTAMP" property="createReceiptsTime" />
            <result column="submission_time" jdbcType="TIMESTAMP" property="submissionTime" />
            <result column="remark" jdbcType="VARCHAR" property="remark" />
            <result column="return_state_id" jdbcType="INTEGER" property="returnStateId" />
        </association>
        <association property="hospital" javaType="com.ygjy.supplymanagement.pojo.Hospital">
            <id column="kid" jdbcType="INTEGER" property="id" />
            <result column="hospital_name" jdbcType="VARCHAR" property="hospitalName" />
            <result column="postal_address" jdbcType="VARCHAR" property="postalAddress" />
            <result column="postal_Code" jdbcType="VARCHAR" property="postalCode" />
            <result column="area" jdbcType="VARCHAR" property="area" />
            <result column="hospital_level" jdbcType="VARCHAR" property="hospitalLevel" />
            <result column="number_of_beds" jdbcType="INTEGER" property="numberOfBeds" />
            <result column="make_money" jdbcType="REAL" property="makeMoney" />
            <result column="hospital_telephone" jdbcType="VARCHAR" property="hospitalTelephone" />
            <result column="hospital_fax" jdbcType="VARCHAR" property="hospitalFax" />
            <result column="pharmacy_telephone" jdbcType="VARCHAR" property="pharmacyTelephone" />
            <result column="hospital_type" jdbcType="VARCHAR" property="hospitalType" />
            <result column="drug_revenue_last_year" jdbcType="VARCHAR" property="drugRevenueLastYear" />
            <result column="business_income_last_year" jdbcType="VARCHAR" property="businessIncomeLastYear" />
        </association>
        <association property="purchaseOrder" javaType="com.ygjy.supplymanagement.pojo.PurchaseOrder">
            <id column="oid" jdbcType="INTEGER" property="id" />
            <result column="purchase_order_number" jdbcType="VARCHAR" property="purchaseOrderNumber" />
            <result column="name_of_purchase_order" jdbcType="VARCHAR" property="nameOfPurchaseOrder" />
            <result column="hospital_id" jdbcType="INTEGER" property="hospitalId" />
            <result column="contacts" jdbcType="VARCHAR" property="contacts" />
            <result column="phone" jdbcType="VARCHAR" property="phone" />
            <result column="create_receipts_times" jdbcType="TIMESTAMP" property="createReceiptsTimes" />
            <result column="last_modification_time" jdbcType="TIMESTAMP" property="lastModificationTime" />
            <result column="submission_times" jdbcType="TIMESTAMP" property="submissionTimes" />
            <result column="remark" jdbcType="VARCHAR" property="remark" />
            <result column="purchase_state" jdbcType="INTEGER" property="purchaseState" />
            <result column="audit_person" jdbcType="VARCHAR" property="auditPerson" />
            <result column="audit_opinion" jdbcType="VARCHAR" property="auditOpinion" />
            <result column="audit_time" jdbcType="TIMESTAMP" property="auditTime" />
            <result column="del_state" jdbcType="INTEGER" property="delState" />
        </association>
        <association property="purchaseOrderDrugDetails" javaType="com.ygjy.supplymanagement.pojo.PurchaseOrderDrugDetails">
            <id column="tid" jdbcType="INTEGER" property="id" />
            <result column="purchase_order_id" jdbcType="INTEGER" property="purchaseOrderId" />
            <result column="drug_information_id" jdbcType="INTEGER" property="drugInformationId" />
            <result column="enterprise_id" jdbcType="INTEGER" property="enterpriseId" />
            <result column="bidding_price" jdbcType="REAL" property="biddingPrice" />
            <result column="transaction_price" jdbcType="REAL" property="transactionPrice" />
            <result column="purchased_amount" jdbcType="INTEGER" property="purchasedAmount" />
            <result column="purchased_money" jdbcType="REAL" property="purchasedMoney" />
            <result column="purchase_orders_states_id" jdbcType="INTEGER" property="purchaseOrdersStatesId" />
        </association>
        <association property="returnStatus" javaType="com.ygjy.supplymanagement.pojo.ReturnStatus">
            <id column="id" jdbcType="INTEGER" property="id" />
            <result column="return_of_state" jdbcType="INTEGER" property="returnOfState" />
            <result column="return_of_explain" jdbcType="VARCHAR" property="returnOfExplain" />
        </association>
        <association property="hospitalTransactionStatement" javaType="com.ygjy.supplymanagement.pojo.HospitalTransactionStatement">
            <id column="id" jdbcType="INTEGER" property="id" />
            <result column="statement_number" jdbcType="VARCHAR" property="statementNumber" />
            <result column="statement_name" jdbcType="VARCHAR" property="statementName" />
            <result column="hospital_id" jdbcType="INTEGER" property="hospitalId" />
            <result column="contacts" jdbcType="VARCHAR" property="contacts" />
            <result column="phone" jdbcType="VARCHAR" property="phone" />
            <result column="creat_receipts_person" jdbcType="VARCHAR" property="creatReceiptsPerson" />
            <result column="create_receipts_time" jdbcType="TIMESTAMP" property="createReceiptsTime" />
            <result column="submission_time" jdbcType="TIMESTAMP" property="submissionTime" />
            <result column="remark" jdbcType="VARCHAR" property="remark" />
            <result column="statement_state_id" jdbcType="INTEGER" property="statementStateId" />
        </association>
        <association property="settlementStatus" javaType="com.ygjy.supplymanagement.pojo.SettlementStatus">
            <id column="id" jdbcType="INTEGER" property="id" />
            <result column="settlement _state" jdbcType="INTEGER" property="settlementState" />
            <result column="settlement _explain" jdbcType="VARCHAR" property="settlementExplain" />
        </association>
    </resultMap>
    <resultMap id="BaseResultMap2" type="com.ygjy.supplymanagement.pojo.DurgsFrom">
        <id column="durg_from_id" jdbcType="INTEGER" property="durgFromId" />
        <result column="drug_from" jdbcType="VARCHAR" property="drugFrom" />
        <result column="note" jdbcType="VARCHAR" property="note" />
    </resultMap>
    <resultMap id="BaseResultMap3" type="com.ygjy.supplymanagement.pojo.DrugCategory">
        <id column="drug_category_Id" property="drugCateGoryId" jdbcType="INTEGER" />
        <result column="drug_category_name" property="drugCategoryName" jdbcType="VARCHAR" />
    </resultMap>
    <resultMap id="BaseResultMap4" type="com.ygjy.supplymanagement.pojo.DrugTransactionStatus">
        <id column="id" jdbcType="INTEGER" property="id" />
        <result column="drug_transaction_status" jdbcType="VARCHAR" property="drugTransactionStatus" />
        <result column="drug_transaction_explain" jdbcType="VARCHAR" property="drugTransactionExplain" />
    </resultMap>
    <resultMap id="BaseResultMap5" type="com.ygjy.supplymanagement.pojo.QualityLevel">
        <id column="qua_id" jdbcType="INTEGER" property="quaId" />
        <result column="level" jdbcType="VARCHAR" property="level" />
    </resultMap>
    <resultMap id="BaseResultMap6" type="com.ygjy.supplymanagement.pojo.Enterprise">
        <id column="id" jdbcType="INTEGER" property="id" />
        <result column="enterprise_name" jdbcType="VARCHAR" property="enterpriseName" />
    </resultMap>
    <resultMap id="BaseResultMap7" type="com.ygjy.supplymanagement.pojo.EnterpriseDrugCatalog">
        <id column="id" jdbcType="INTEGER" property="id" />
        <result column="enterprise_id" jdbcType="INTEGER" property="enterpriseId" />
        <result column="drug_information_id" jdbcType="INTEGER" property="drugInformationId" />
    </resultMap>
    <resultMap id="BaseResultMap8" type="com.ygjy.supplymanagement.pojo.Suppliers">
        <id column="suppliers_id" jdbcType="INTEGER" property="suppliersid" />
        <result column="supplier_name" jdbcType="INTEGER" property="suppliername" />
    </resultMap>
    <resultMap id="BaseResultMap9" type="com.ygjy.supplymanagement.pojo.ReturnStatus">
        <id column="id" jdbcType="INTEGER" property="id" />
        <result column="return_of_state" jdbcType="INTEGER" property="returnOfState" />
        <result column="return_of_explain" jdbcType="VARCHAR" property="returnOfExplain" />
    </resultMap>
    <resultMap id="BaseResultMap10" type="com.ygjy.supplymanagement.pojo.SettlementStatus">
        <id column="id" jdbcType="INTEGER" property="id" />
        <result column="settlement _state" jdbcType="INTEGER" property="settlementState" />
        <result column="settlement _explain" jdbcType="VARCHAR" property="settlementExplain" />
    </resultMap>
    <sql id="Base_Column_List">
    i.serial_number, i.common_name, i.dosage_form_id, i.specification, i.conversion_fraction,
    i.enterprise_name_id, i.trade_name, i.bidding_price, i.unit, i.common_name_pinyin,i. product_picture,
    i.approval_number, i.validity_of_approval_number, i.imported_drug, i.packaging_material,
    i.packing_unit, i.latest_retail_price, i.source_of_retail_price, i.quality_level_id,i.quality_level_description,
    i.drug_inspection_report, i.drug_inspection_report_number, i.validity_of_drug_inspection_report,
    i.description_of_products, i.drug_category_id, i.drug_transaction_status_id, i.del_state,i.audit_status,i.id
  </sql>
    <!--药品品目模糊查询及全部查询-->
    <select id="getQuery" resultMap="BaseResultMap">
        SELECT
        i.`id` AS iid ,c.`drug_category_Id` AS cid,s.`id` AS sid,e.`id` AS eid,d.`drug_from`,d.`note`,c.`drug_category_Id`,c.`drug_category_name`,s.`drug_transaction_explain`,s.`drug_transaction_status` ,d.`durg_from_id`,l.`qua_id`,l.`level`,e.enterprise_name,
        <include refid="Base_Column_List" />
        FROM drug_information i
        LEFT JOIN durgs_from d ON d.`durg_from_id`=i.`dosage_form_id`
        LEFT JOIN drug_category c ON c.`drug_category_Id`=i.`drug_category_id`
        LEFT JOIN drug_transaction_status s ON s.`id`=i.`drug_transaction_status_id`
        LEFT JOIN quality_level l ON l.`qua_id`=i.`quality_level_id`
        LEFT JOIN enterprise e ON e.`id`=i.`enterprise_name_id`
        WHERE i.`del_state`=0
        <if test="commonName != null and commonName != ''">
            and common_name like CONCAT('%',#{commonName,jdbcType=VARCHAR},'%')
        </if>
        <if test="serialNumber != null and serialNumber != ''">
            and serial_number like CONCAT('%',#{serialNumber,jdbcType=VARCHAR},'%')
        </if>
        <if test="dosageFormId != null">
            and d.`durg_from_id` like CONCAT('%',#{dosageFormId,jdbcType=INTEGER},'%')
        </if>
        <if test="specification != null and specification != ''">
            and specification like CONCAT('%',#{specification,jdbcType=VARCHAR},'%')
        </if>
        <if test="unit != null and unit != ''">
            and unit like CONCAT('%',#{unit,jdbcType=VARCHAR},'%')
        </if>
        <if test="conversionFraction != null and conversionFraction != ''">
            and conversion_fraction like CONCAT('%',#{conversionFraction,jdbcType=VARCHAR},'%')
        </if>
        <if test="drugCategoryId != null">
            and c.`drug_category_id` like CONCAT('%',#{drugCategoryId,jdbcType=INTEGER},'%')
        </if>
        <if test="drugTransactionStatusId != null">
            and `drug_transaction_status_id` like CONCAT('%',#{drugTransactionStatusId,jdbcType=INTEGER},'%')
        </if>
        <if test="enterpriseNameId != null">
            and `enterprise_name_id` like CONCAT('%',#{enterpriseNameId,jdbcType=INTEGER},'%')
        </if>
        <if test="tradeName != null and tradeName != ''">
            and `trade_name` like CONCAT('%',#{tradeName,jdbcType=VARCHAR},'%')
        </if>
        <if test="latestRetailPrice != null">
            and i.`latest_retail_price` BETWEEN #{latestRetailPrice,jdbcType=REAL} and #{latestRetailPrice,jdbcType=REAL}
        </if>
        <if test="qualityLevelId != null">
            and `quality_level_id` like CONCAT('%',#{qualityLevelId,jdbcType=INTEGER},'%')
        </if>
    </select>
    <!--条件查询-->
    <select id="getSelect" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        SELECT
        i.`id` AS iid ,c.`drug_category_Id` AS cid,s.`id` AS sid,e.`id` AS eid,d.`drug_from`,d.`note`,c.`drug_category_name`,s.`drug_transaction_explain`,s.`drug_transaction_status` ,d.`durg_from_id`,l.`qua_id`,l.`level`,e.enterprise_name,r.`suppliers_id`,r.`supplier_name`,
        <include refid="Base_Column_List" />
        FROM drug_information i
        LEFT JOIN durgs_from d ON d.`durg_from_id`=i.`dosage_form_id`
        LEFT JOIN drug_category c ON c.`drug_category_Id`=i.`drug_category_id`
        LEFT JOIN drug_transaction_status s ON s.`id`=i.`drug_transaction_status_id`
        LEFT JOIN quality_level l ON l.`qua_id`=i.`quality_level_id`
        LEFT JOIN enterprise e ON e.`id`=i.`enterprise_name_id`
        LEFT JOIN suppliers r ON r.`suppliers_id`=e.`suppliers_id`
        where i.`del_state`=0 and i.`id` = #{id,jdbcType=INTEGER}
    </select>
    <!--剂型表查询-->
    <select id="selectDurgsFrom" resultMap="BaseResultMap2">
        SELECT * FROM durgs_from
    </select>
    <!--药品类别表查询-->
    <select id="selectDrugCategory" resultMap="BaseResultMap3">
         SELECT * FROM drug_category
    </select>
    <!--药品交易状态表查询-->
    <select id="selectDrugTransactionStatus" resultMap="BaseResultMap4">
         SELECT * FROM drug_transaction_status
    </select>
    <!--质量层次-->
    <select id="qualityLevel" resultMap="BaseResultMap5">
         SELECT * FROM quality_level
    </select>
    <!--企业-->
    <select id="enterPrise" resultMap="BaseResultMap6">
        SELECT id,enterprise_name FROM enterprise
    </select>
    <!--导出-->
    <select id="importselect" resultMap="BaseResultMap">
        SELECT
        i.`id` AS iid ,c.`drug_category_Id` AS cid,s.`id` AS sid,e.`id` AS eid,d.`drug_from`,d.`note`,c.`drug_category_name`,s.`drug_transaction_explain`,s.`drug_transaction_status` ,d.`durg_from_id`,l.`qua_id`,l.`level`,e.enterprise_name,r.`supplier_name`,
        <include refid="Base_Column_List" />
        FROM drug_information i
        LEFT JOIN durgs_from d ON d.`durg_from_id`=i.`dosage_form_id`
        LEFT JOIN drug_category c ON c.`drug_category_Id`=i.`drug_category_id`
        LEFT JOIN drug_transaction_status s ON s.`id`=i.`drug_transaction_status_id`
        LEFT JOIN quality_level l ON l.`qua_id`=i.`quality_level_id`
        LEFT JOIN enterprise e ON e.`id`=i.`enterprise_name_id`
        LEFT JOIN suppliers r ON r.`suppliers_id`=e.`suppliers_id`
        where i.`id` in
        <foreach collection="array" item="items" open="(" separator="," close=")">
            #{items}
        </foreach>
    </select>
    <!--选择供货-->
    <insert id="insertSelective" parameterType="com.ygjy.pojo.EnterpriseDrugCatalog">
        insert into enterprise_drug_catalog
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="enterpriseId != null">
                enterprise_id,
            </if>
            <if test="drugInformationId != null">
                drug_information_id,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=INTEGER},
            </if>
            <if test="enterpriseId != null">
                #{enterpriseId,jdbcType=INTEGER},
            </if>
            <if test="drugInformationId != null">
                #{drugInformationId,jdbcType=INTEGER},
            </if>
        </trim>
    </insert>
    <!--供应商药品目录表查询-->
    <select id="selectEnterpriseDrugCatalog" resultMap="BaseResultMap7">
        SELECT * FROM enterprise_drug_catalog
    </select>
    <!--选择供货查询-->
    <select id="backSelect" resultMap="BaseResultMap">
        SELECT
        i.`id` AS iid ,e.`id` AS eid,e.enterprise_name,f.id AS fid,r.`suppliers_id`,r.`supplier_name`,u.`drug_from`,l.`level`,s.`drug_transaction_explain`,c.`drug_category_name`,
        <include refid="Base_Column_List" />
        FROM drug_information i
        INNER JOIN `enterprise_drug_catalog` f ON i.`id`=f.`drug_information_id`
        INNER JOIN enterprise e ON e.`id`=f.`enterprise_id`
        INNER JOIN suppliers r ON r.`suppliers_id`=e.`suppliers_id`
        INNER JOIN drug_category c ON c.`drug_category_Id`=i.`drug_category_id`
        LEFT JOIN durgs_from u ON u.`durg_from_id`=i.`dosage_form_id`
        INNER JOIN quality_level l ON  l.`qua_id`=i.`quality_level_id`
        INNER JOIN drug_transaction_status s ON s.`drug_transaction_status`=i.`drug_transaction_status_id`
        <if test="commonName != null and commonName != ''">
            and common_name like CONCAT('%',#{commonName,jdbcType=VARCHAR},'%')
        </if>
        <if test="serialNumber != null and serialNumber != ''">
            and serial_number like CONCAT('%',#{serialNumber,jdbcType=VARCHAR},'%')
        </if>
        <if test="dosageFormId != null">
            and i.`dosage_form_id` like CONCAT('%',#{dosageFormId,jdbcType=INTEGER},'%')
        </if>
        <if test="specification != null and specification != ''">
            and specification like CONCAT('%',#{specification,jdbcType=VARCHAR},'%')
        </if>
        <if test="unit != null and unit != ''">
            and unit like CONCAT('%',#{unit,jdbcType=VARCHAR},'%')
        </if>
        <if test="conversionFraction != null and conversionFraction != ''">
            and conversion_fraction like CONCAT('%',#{conversionFraction,jdbcType=VARCHAR},'%')
        </if>
        <if test="drugCategoryId != null">
            and i.`drug_category_id` like CONCAT('%',#{drugCategoryId,jdbcType=INTEGER},'%')
        </if>
        <if test="drugTransactionStatusId != null">
            and `drug_transaction_status_id` like CONCAT('%',#{drugTransactionStatusId,jdbcType=INTEGER},'%')
        </if>
        <if test="enterpriseNameId != null">
            and `enterprise_name_id` like CONCAT('%',#{enterpriseNameId,jdbcType=INTEGER},'%')
        </if>
        <if test="tradeName != null and tradeName != ''">
            and `trade_name` like CONCAT('%',#{tradeName,jdbcType=VARCHAR},'%')
        </if>
        <if test="latestRetailPrice != null">
            and i.`latest_retail_price` BETWEEN #{latestRetailPrice,jdbcType=REAL} and #{latestRetailPrice,jdbcType=REAL}
        </if>
        <if test="qualityLevelId != null">
            and `quality_level_id` like CONCAT('%',#{qualityLevelId,jdbcType=INTEGER},'%')
        </if>
        <if test="suppliersid != null">
            and r.`suppliers_id` like CONCAT('%',#{suppliersid,jdbcType=INTEGER},'%')
        </if>
        <if test="auditStatus != null" >
            and `audit_status` like CONCAT('%',#{auditStatus,jdbcType=INTEGER},'%')
        </if>
    </select>
    <!--取消供货批量删除 -->
    <delete id="falseDelete">
        DELETE FROM enterprise_drug_catalog where id in
        <foreach collection="array" index="index" item="item" open="(" separator="," close=")">
            #{item}
        </foreach>
    </delete>
    <!--供应商查询-->
    <select id="supplierSelect" resultMap="BaseResultMap8">
          SELECT*FROM suppliers
    </select>
    <!--修改商品信息维护-->
    <update id="updateByPrimaryKeySelectives" parameterType="com.ygjy.supplymanagement.pojo.DrugInformation">
        update drug_information
        <set>
            <if test="serialNumber != null">
                serial_number = #{serialNumber,jdbcType=VARCHAR},
            </if>
            <if test="commonName != null">
                common_name = #{commonName,jdbcType=VARCHAR},
            </if>
            <if test="dosageFormId != null">
                dosage_form_id = #{dosageFormId,jdbcType=INTEGER},
            </if>
            <if test="specification != null">
                specification = #{specification,jdbcType=VARCHAR},
            </if>
            <if test="conversionFraction != null">
                conversion_fraction = #{conversionFraction,jdbcType=VARCHAR},
            </if>
            <if test="enterpriseNameId != null">
                enterprise_name_id = #{enterpriseNameId,jdbcType=INTEGER},
            </if>
            <if test="tradeName != null">
                trade_name = #{tradeName,jdbcType=VARCHAR},
            </if>
            <if test="biddingPrice != null">
                bidding_price = #{biddingPrice,jdbcType=REAL},
            </if>
            <if test="unit != null">
                unit = #{unit,jdbcType=VARCHAR},
            </if>
            <if test="commonNamePinyin != null">
                common_name_pinyin = #{commonNamePinyin,jdbcType=VARCHAR},
            </if>
            <if test="productPicture != null">
                product_picture = #{productPicture,jdbcType=VARCHAR},
            </if>
            <if test="approvalNumber != null">
                approval_number = #{approvalNumber,jdbcType=VARCHAR},
            </if>
            <if test="validityOfApprovalNumber != null">
                validity_of_approval_number = #{validityOfApprovalNumber,jdbcType=VARCHAR},
            </if>
            <if test="importedDrug != null">
                imported_drug = #{importedDrug,jdbcType=INTEGER},
            </if>
            <if test="packagingMaterial != null">
                packaging_material = #{packagingMaterial,jdbcType=VARCHAR},
            </if>
            <if test="packingUnit != null">
                packing_unit = #{packingUnit,jdbcType=VARCHAR},
            </if>
            <if test="latestRetailPrice != null">
                latest_retail_price = #{latestRetailPrice,jdbcType=REAL},
            </if>
            <if test="sourceOfRetailPrice != null">
                source_of_retail_price = #{sourceOfRetailPrice,jdbcType=VARCHAR},
            </if>
            <if test="qualityLevelId != null">
                quality_level_id = #{qualityLevelId,jdbcType=INTEGER},
            </if>
            <if test="qualityLevelDescription != null">
                quality_level_description = #{qualityLevelDescription,jdbcType=VARCHAR},
            </if>
            <if test="drugInspectionReport != null">
                drug_inspection_report = #{drugInspectionReport,jdbcType=INTEGER},
            </if>
            <if test="drugInspectionReportNumber != null">
                drug_inspection_report_number = #{drugInspectionReportNumber,jdbcType=VARCHAR},
            </if>
            <if test="validityOfDrugInspectionReport != null">
                validity_of_drug_inspection_report = #{validityOfDrugInspectionReport,jdbcType=DATE},
            </if>
            <if test="descriptionOfProducts != null">
                description_of_products = #{descriptionOfProducts,jdbcType=VARCHAR},
            </if>
            <if test="drugCategoryId != null">
                drug_category_id = #{drugCategoryId,jdbcType=INTEGER},
            </if>
            <if test="drugTransactionStatusId != null">
                drug_transaction_status_id = #{drugTransactionStatusId,jdbcType=INTEGER},
            </if>
            <if test="delState != null">
                del_state = #{delState,jdbcType=INTEGER},
            </if>
            <if test="auditStatus != null">
                audit_status = #{auditStatus,jdbcType=INTEGER},
            </if>
        </set>
        where id = #{id,jdbcType=INTEGER}
    </update>
    <!--退货单处理-->
    <select id="returnSelect" resultMap="BaseResultMap">
        SELECT  i.`id` AS iid,m.`return_order_number`,m.`return_order_name`,h.`hospital_name`,m.`create_receipts_time`,m.`submission_time`,
        o.`purchase_order_number`,o.`name_of_purchase_order`,a.`purchased_amount`,a.`purchased_money`,a.`bidding_price` AS price
        ,a.`transaction_price`,a.`receipt_amount`,a.`receipt_money`,a.`Invoice_number`,a.`drug_batch_number`,a.`drug_Validity`
        ,a.`final_settlement _amount`,a.`final_settlement _money`,a.`returns_the_amount`,a.`returns_the_money`,a.`reason_for_return`,
        m.`return_state_id`,o.`create_receipts_times`,o.`submission_times`,a.`return_order_id`,l.`level`,l.`qua_id`,e.`enterprise_name`,e.`id` AS eid,d.`drug_from`
        ,m.`return_state_id`,
        <include refid="Base_Column_List" />
        FROM drug_information i
        INNER JOIN durgs_from d ON d.`durg_from_id`=i.`dosage_form_id`
        INNER JOIN drug_category c ON c.`drug_category_Id`=i.`drug_category_id`
        INNER JOIN drug_transaction_status s ON s.`id`=i.`drug_transaction_status_id`
        INNER JOIN quality_level l ON l.`qua_id`=i.`quality_level_id`
        INNER JOIN enterprise e ON e.`id`=i.`enterprise_name_id`
        INNER JOIN hospital_transaction_details a ON a.`drug_information_id`=i.`id`
        INNER JOIN hospital_transaction_return m ON m.`id`=a.`final_settlement _id`
        INNER JOIN hospital h ON h.`id`=m.`hospital_id`
        INNER JOIN purchase_order o ON o.`hospital_id`=h.`id`
        WHERE i.`del_state`=0 AND m.`return_state_id`=2 AND a.`return_state_id`=1
        <if test="returnOrderNumber != null and returnOrderNumber != ''">
            and m.return_order_number like CONCAT('%',#{returnOrderNumber,jdbcType=VARCHAR},'%')
        </if>
        <if test="returnOrderName != null and returnOrderName != ''">
            and m.return_order_name like CONCAT('%',#{returnOrderName,jdbcType=VARCHAR},'%')
        </if>
        <if test="returnStateId != null and returnStateId != ''">
            and m.return_state_id like CONCAT('%',#{returnStateId,jdbcType=INTEGER},'%')
        </if>
        <if test="createReceiptsTime != null and createReceiptsTime != ''">
            and m.create_receipts_time BETWEEN #{createReceiptsTime}  AND #{submissionTime}
        </if>
        <if test="submissionTime != null and submissionTime != ''">
            and m.submission_time BETWEEN #{createReceiptsTime}  AND #{submissionTime}
        </if>
        <if test="hospitalName != null and hospitalName != ''">
            and h.hospital_name like CONCAT('%',#{hospitalName,jdbcType=VARCHAR},'%')
        </if>
        <if test="createReceiptsTimes != null and createReceiptsTimes != ''">
            and o.create_receipts_times BETWEEN #{createReceiptsTimes}  AND #{submissionTimes}
        </if>
        <if test="submissionTimes != null and submissionTimes != ''">
            and o.submission_times BETWEEN #{createReceiptsTimes}  AND #{submissionTimes}
        </if>
        <if test="purchaseOrderNumber != null and purchaseOrderNumber != ''">
            and o.purchase_order_number like CONCAT('%',#{purchaseOrderNumber,jdbcType=VARCHAR},'%')
        </if>
        <if test="nameOfPurchaseOrder != null and nameOfPurchaseOrder != ''">
            and o.name_of_purchase_order like CONCAT('%',#{nameOfPurchaseOrder,jdbcType=VARCHAR},'%')
        </if>
        <if test="commonName != null and commonName != ''">
            and i.common_name like CONCAT('%',#{commonName,jdbcType=VARCHAR},'%')
        </if>
        <if test="serialNumber != null and serialNumber != ''">
            and i.serial_number like CONCAT('%',#{serialNumber,jdbcType=VARCHAR},'%')
        </if>
        <if test="dosageFormId != null">
            and i.`durg_from_id` like CONCAT('%',#{dosageFormId,jdbcType=INTEGER},'%')
        </if>
        <if test="specification != null and specification != ''">
            and i.specification like CONCAT('%',#{specification,jdbcType=VARCHAR},'%')
        </if>
        <if test="unit != null and unit != ''">
            and i.unit like CONCAT('%',#{unit,jdbcType=VARCHAR},'%')
        </if>
        <if test="conversionFraction != null and conversionFraction != ''">
            and i.conversion_fraction like CONCAT('%',#{conversionFraction,jdbcType=VARCHAR},'%')
        </if>
        <if test="drugCategoryId != null">
            and i.`drug_category_id` like CONCAT('%',#{drugCategoryId,jdbcType=INTEGER},'%')
        </if>
        <if test="enterpriseNameId != null">
            and i.`enterprise_name_id` like CONCAT('%',#{enterpriseNameId,jdbcType=INTEGER},'%')
        </if>
        <if test="tradeName != null and tradeName != ''">
            and i.`trade_name` like CONCAT('%',#{tradeName,jdbcType=VARCHAR},'%')
        </if>
        <if test="qualityLevelId != null">
            and i.`quality_level_id` like CONCAT('%',#{qualityLevelId,jdbcType=INTEGER},'%')
        </if>
    </select>
    <!--退货状态查询-->
    <select id="selectReturnStatus" resultMap="BaseResultMap9">
        SELECT *FROM return_status
    </select>
    <!--结算单查询-->
    <select id="selectPurchaseOrder" resultMap="BaseResultMap">
        SELECT	 i.`id` AS iid,m.`statement_number`,m.`statement_name`,h.`hospital_name`,m.`create_receipts_time`,m.`submission_time`,
        o.`purchase_order_number`,o.`name_of_purchase_order`,a.`purchased_amount`,a.`purchased_money`,a.`bidding_price` AS price
        ,a.`transaction_price`,a.`receipt_amount`,a.`receipt_money`,a.`Invoice_number`,a.`drug_batch_number`,a.`drug_Validity`
        ,a.`final_settlement _amount`,a.`final_settlement _money`,d.`durg_from_id`,d.`drug_from`,l.`qua_id`,l.`level`,e.`enterprise_name`,a.`final_settlement _id`,
        <include refid="Base_Column_List" />
        FROM drug_information i
        INNER JOIN durgs_from d ON d.`durg_from_id`=i.`dosage_form_id`
        INNER JOIN drug_category c ON c.`drug_category_Id`=i.`drug_category_id`
        INNER JOIN drug_transaction_status s ON s.`id`=i.`drug_transaction_status_id`
        INNER JOIN quality_level l ON l.`qua_id`=i.`quality_level_id`
        INNER JOIN enterprise e ON e.`id`=i.`enterprise_name_id`
        INNER JOIN hospital_transaction_details a ON a.`drug_information_id`=i.`id`
        INNER JOIN hospital_transaction_statement m ON m.`id`=a.`final_settlement _id`
        INNER JOIN hospital h ON h.`id`=m.`hospital_id`
        INNER JOIN purchase_order o ON o.`hospital_id`=h.`id`
        WHERE i.`del_state`=0 AND m.`statement_state_id`=2 AND a.`final_settlement _id`=1
        <if test="statementNumber != null and statementNumber != ''">
            and m.statement_number like CONCAT('%',#{statementNumber,jdbcType=VARCHAR},'%')
        </if>
        <if test="statementName != null and statementName != ''">
            and m.statement_name like CONCAT('%',#{statementName,jdbcType=VARCHAR},'%')
        </if>
        <if test="hospitalName != null and hospitalName != ''">
            and h.hospital_name like CONCAT('%',#{hospitalName,jdbcType=INTEGER},'%')
        </if>
        <if test="createReceiptsTime != null and createReceiptsTime != ''">
            and m.create_receipts_time BETWEEN #{createReceiptsTime}  AND #{submissionTime}
        </if>
        <if test="submissionTime != null and submissionTime != ''">
            and m..submission_time BETWEEN #{createReceiptsTime}  AND #{submissionTime}
        </if>
        <if test="statementStateId != null and statementStateId != ''">
            and m.statement_state_id like CONCAT('%',#{statementStateId,jdbcType=INTEGER},'%')
        </if>
        <if test="purchaseOrderNumber != null and purchaseOrderNumber != ''">
            and o.purchase_order_number like CONCAT('%',#{purchaseOrderNumber,jdbcType=VARCHAR},'%')
        </if>
        <if test="nameOfPurchaseOrder != null and nameOfPurchaseOrder != ''">
            and o.name_of_purchase_order like CONCAT('%',#{nameOfPurchaseOrder,jdbcType=VARCHAR},'%')
        </if>
        <if test="commonName != null and commonName != ''">
            and common_name like CONCAT('%',#{commonName,jdbcType=VARCHAR},'%')
        </if>
        <if test="serialNumber != null and serialNumber != ''">
            and serial_number like CONCAT('%',#{serialNumber,jdbcType=VARCHAR},'%')
        </if>
        <if test="dosageFormId != null">
            and `durg_from_id` like CONCAT('%',#{dosageFormId,jdbcType=INTEGER},'%')
        </if>
        <if test="specification != null and specification != ''">
            and specification like CONCAT('%',#{specification,jdbcType=VARCHAR},'%')
        </if>
        <if test="unit != null and unit != ''">
            and unit like CONCAT('%',#{unit,jdbcType=VARCHAR},'%')
        </if>
        <if test="conversionFraction != null and conversionFraction != ''">
            and conversion_fraction like CONCAT('%',#{conversionFraction,jdbcType=VARCHAR},'%')
        </if>
        <if test="drugCategoryId != null">
            and i.`drug_category_id` like CONCAT('%',#{drugCategoryId,jdbcType=INTEGER},'%')
        </if>
        <if test="enterpriseNameId != null">
            and `enterprise_name_id` like CONCAT('%',#{enterpriseNameId,jdbcType=INTEGER},'%')
        </if>
        <if test="tradeName != null and tradeName != ''">
            and `trade_name` like CONCAT('%',#{tradeName,jdbcType=VARCHAR},'%')
        </if>
        <if test="qualityLevelId != null">
            and `quality_level_id` like CONCAT('%',#{qualityLevelId,jdbcType=INTEGER},'%')
        </if>
    </select>
    <!--结算状态查询-->
    <select id="selectSettlementStatus" resultMap="BaseResultMap10">
         SELECT *FROM settlement_status
    </select>
    <!--导出退货单-->
    <select id="selectReturnExport" resultMap="BaseResultMap">
        SELECT  i.`id` AS iid,m.`return_order_number`,m.`return_order_name`,h.`hospital_name`,m.`create_receipts_time`,m.`submission_time`,
        o.`purchase_order_number`,o.`name_of_purchase_order`,a.`purchased_amount`,a.`purchased_money`,a.`bidding_price` AS price
        ,a.`transaction_price`,a.`receipt_amount`,a.`receipt_money`,a.`Invoice_number`,a.`drug_batch_number`,a.`drug_Validity`
        ,a.`final_settlement _amount`,a.`final_settlement _money`,a.`returns_the_amount`,a.`returns_the_money`,a.`reason_for_return`,
        m.`return_state_id`,o.`create_receipts_times`,o.`submission_times`,a.`return_order_id`,l.`level`,l.`qua_id`,e.`enterprise_name`,e.`id` AS eid,d.`drug_from`
        ,m.`return_state_id`,
        <include refid="Base_Column_List" />
        FROM drug_information i
        INNER JOIN durgs_from d ON d.`durg_from_id`=i.`dosage_form_id`
        INNER JOIN drug_category c ON c.`drug_category_Id`=i.`drug_category_id`
        INNER JOIN drug_transaction_status s ON s.`id`=i.`drug_transaction_status_id`
        INNER JOIN quality_level l ON l.`qua_id`=i.`quality_level_id`
        INNER JOIN enterprise e ON e.`id`=i.`enterprise_name_id`
        INNER JOIN hospital_transaction_details a ON a.`drug_information_id`=i.`id`
        INNER JOIN hospital_transaction_return m ON m.`id`=a.`final_settlement _id`
        INNER JOIN hospital h ON h.`id`=m.`hospital_id`
        INNER JOIN purchase_order o ON o.`hospital_id`=h.`id`
        WHERE i.`del_state`=0 AND m.`return_state_id`=2 AND a.`return_state_id`=1 and i.`id` in
        <foreach collection="array" item="items" open="(" separator="," close=")">
            #{items}
        </foreach>
    </select>
    <!--导出结算单-->
    <select id="selectSettlementExport" resultMap="BaseResultMap">
        SELECT	 i.`id` AS iid,m.`statement_number`,m.`statement_name`,h.`hospital_name`,m.`create_receipts_time`,m.`submission_time`,
        o.`purchase_order_number`,o.`name_of_purchase_order`,a.`purchased_amount`,a.`purchased_money`,a.`bidding_price` AS price
        ,a.`transaction_price`,a.`receipt_amount`,a.`receipt_money`,a.`Invoice_number`,a.`drug_batch_number`,a.`drug_Validity`
        ,a.`final_settlement _amount`,a.`final_settlement _money`,d.`durg_from_id`,d.`drug_from`,l.`qua_id`,l.`level`,e.`enterprise_name`,a.`final_settlement _id`,
        <include refid="Base_Column_List" />
        FROM drug_information i
        INNER JOIN durgs_from d ON d.`durg_from_id`=i.`dosage_form_id`
        INNER JOIN drug_category c ON c.`drug_category_Id`=i.`drug_category_id`
        INNER JOIN drug_transaction_status s ON s.`id`=i.`drug_transaction_status_id`
        INNER JOIN quality_level l ON l.`qua_id`=i.`quality_level_id`
        INNER JOIN enterprise e ON e.`id`=i.`enterprise_name_id`
        INNER JOIN hospital_transaction_details a ON a.`drug_information_id`=i.`id`
        INNER JOIN hospital_transaction_statement m ON m.`id`=a.`final_settlement _id`
        INNER JOIN hospital h ON h.`id`=m.`hospital_id`
        INNER JOIN purchase_order o ON o.`hospital_id`=h.`id`
        WHERE i.`del_state`=0 AND m.`statement_state_id`=2 AND a.`final_settlement _id`=1 and i.`id` in
        <foreach collection="array" item="items" open="(" separator="," close=")">
            #{items}
        </foreach>
    </select>
    <!--确认退货-->
    <update id="updateByPrimaryKeyReturn" >
        update hospital_transaction_details
        set
        `return_state_id` =2
        where id in
        <foreach collection="array" item="items" open="(" separator="," close=")">
            #{items}
        </foreach>
    </update>
    <!--确认结算-->
    <update id="updateByPrimaryKeySettment">
        UPDATE hospital_transaction_details
        SET `final_settlement _id`=2
        WHERE id in
        <foreach collection="array" item="items" open="(" separator="," close=")">
            #{items}
        </foreach>
    </update>
    <!--采购单处理-->
    <select id="selectPurchaseOrderProcessing" resultMap="BaseResultMap">
        SELECT i.id AS iid,o.`purchase_order_number`,o.`name_of_purchase_order`,h.`hospital_name`,o.`create_receipts_times`,o.`submission_times`,
        e.`enterprise_name`,s.`bidding_price`,s.`transaction_price`,s.`purchased_amount`,s.`purchased_money`,p.`purchase_orders_states_id`,f.`drug_from`,
        <include refid="Base_Column_List" />
        FROM hospital_transaction_details s
        INNER JOIN drug_information i ON i.id=s.`drug_information_id`
        INNER JOIN enterprise e ON e.id=i.`enterprise_name_id`
        INNER JOIN purchase_order o ON o.id=s.`purchase_orders_id`
        INNER JOIN hospital h ON h.id=o.`hospital_id`
        INNER JOIN purchase_order_drug_details p ON p.`purchase_order_id`=o.`id`
        INNER JOIN durgs_from f ON f.`durg_from_id`=i.`dosage_form_id`
        WHERE o.`purchase_state`=2 AND i.`del_state`=0 AND p.`purchase_orders_states_id`=1
        <if test="purchaseOrderNumber != null and purchaseOrderNumber != ''">
            and o.`purchase_order_number like CONCAT('%',#{purchaseOrderNumber,jdbcType=VARCHAR},'%')
        </if>
        <if test="nameOfPurchaseOrder != null and nameOfPurchaseOrder != ''">
            and o.`name_of_purchase_order` like CONCAT('%',#{nameOfPurchaseOrder,jdbcType=VARCHAR},'%')
        </if>
        <if test="purchaseOrdersStatesId != null and purchaseOrdersStatesId != ''">
            and p.purchase_orders_states_id like CONCAT('%',#{purchaseOrdersStatesId,jdbcType=INTEGER},'%')
        </if>
        <if test="hospitalName != null and hospitalName != ''">
            and h.hospital_name like CONCAT('%',#{hospitalName,jdbcType=VARCHAR},'%')
        </if>
        <if test="createReceiptsTimes != null and createReceiptsTimes != ''">
            and o.`create_receipts_times` BETWEEN #{createReceiptsTimes}  AND #{submissionTimes}
        </if>
        <if test="submissionTimes != null and submissionTimes != ''">
            and o.`submission_times` BETWEEN #{createReceiptsTimes}  AND #{submissionTimes}
        </if>
        <if test="serialNumber != null and serialNumber != ''">
            and serial_number like CONCAT('%',#{serialNumber,jdbcType=VARCHAR},'%')
        </if>
        <if test="commonName != null and commonName != ''">
            and common_name like CONCAT('%',#{commonName,jdbcType=VARCHAR},'%')
        </if>
        <if test="dosageFormId != null">
            and `durg_from_id` like CONCAT('%',#{dosageFormId,jdbcType=INTEGER},'%')
        </if>
        <if test="specification != null and specification != ''">
            and specification like CONCAT('%',#{specification,jdbcType=VARCHAR},'%')
        </if>
        <if test="unit != null and unit != ''">
            and unit like CONCAT('%',#{unit,jdbcType=VARCHAR},'%')
        </if>
        <if test="conversionFraction != null and conversionFraction != ''">
            and conversion_fraction like CONCAT('%',#{conversionFraction,jdbcType=VARCHAR},'%')
        </if>
        <if test="tradeName != null and tradeName != ''">
            and `trade_name` like CONCAT('%',#{tradeName,jdbcType=VARCHAR},'%')
        </if>
        <if test="enterpriseNameId != null">
            and `enterprise_name_id` like CONCAT('%',#{enterpriseNameId,jdbcType=INTEGER},'%')
        </if>
        <if test="drugCategoryId != null">
            and i.`drug_category_id` like CONCAT('%',#{drugCategoryId,jdbcType=INTEGER},'%')
        </if>
    </select>
    <!--采购单导出-->
    <select id="selectPurchaseOrderProcessingExport" resultMap="BaseResultMap">
        SELECT o.`purchase_order_number`,o.`name_of_purchase_order`,h.`hospital_name`,o.`create_receipts_times`,o.`submission_times`,
        e.`enterprise_name`,s.`bidding_price`,s.`transaction_price`,s.`purchased_amount`,s.`purchased_money`,p.`purchase_orders_states_id`,f.`drug_from`,
        <include refid="Base_Column_List" />
        FROM hospital_transaction_details s
        INNER JOIN drug_information i ON i.id=s.`drug_information_id`
        INNER JOIN enterprise e ON e.id=i.`enterprise_name_id`
        INNER JOIN purchase_order o ON o.id=s.`purchase_orders_id`
        INNER JOIN hospital h ON h.id=o.`hospital_id`
        INNER JOIN purchase_order_drug_details p ON p.`purchase_order_id`=o.`id`
        INNER JOIN durgs_from f ON f.`durg_from_id`=i.`dosage_form_id`
        WHERE o.`purchase_state`=2 AND i.`del_state`=0 AND p.`purchase_orders_states_id`=1 and i.id in
        <foreach collection="array" item="items" open="(" separator="," close=")">
            #{items}
        </foreach>
    </select>
    <!--选择发货-->
    <update id="updateReturnGoods">
        UPDATE purchase_order_drug_details s
        SET s.`purchase_orders_states_id`=2
        WHERE s.`id` IN
        <foreach collection="array" item="items" open="(" separator="," close=")">
            #{items}
        </foreach>
    </update>
    <!--无法供货-->
    <update id="updateUnableToSupply">
        UPDATE purchase_order_drug_details s
        SET s.`purchase_orders_states_id`=4
        WHERE s.`id` IN
        <foreach collection="array" item="items" open="(" separator="," close=")">
            #{items}
        </foreach>
    </update>
</mapper>